[supervisord]
nodaemon=true
logfile=/dev/stdout
logfile_maxbytes=0

[program:uvicorn]
; Hugging Face injects PORT; we read it via %(ENV_PORT)s
command=uvicorn %(ENV_APP_MODULE)s --host 0.0.0.0 --port %(ENV_PORT)s
directory=/app
autostart=true
autorestart=true
stopasgroup=true
killasgroup=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=PYTHONPATH="/app"

[program:celery_worker]
; match your Celery app path; you said app/core/celery_app.py defines celery_app
command=celery -A app.core.celery_app.celery_app worker -Q deck -l info --pool=solo --concurrency=1
directory=/app
autostart=true
autorestart=true
startsecs=3
stopasgroup=true
killasgroup=true
stdout_logfile=/dev/stdout
stdout_logfile_maxbytes=0
stderr_logfile=/dev/stderr
stderr_logfile_maxbytes=0
environment=PYTHONPATH="/app"
